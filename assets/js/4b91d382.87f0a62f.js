"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9769],{1487:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"2","metadata":{"permalink":"/dev/2","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/23.01/2024-01-04-02-\uc120\ucc29\uc21c\uc774\ubca4\ud2b8\uc2dc\uc2a4\ud15c.md","source":"@site/blog/23.01/2024-01-04-02-\uc120\ucc29\uc21c\uc774\ubca4\ud2b8\uc2dc\uc2a4\ud15c.md","title":"\uc120\ucc29\uc21c \uc774\ubca4\ud2b8\ub97c Redis\uc640 Kafka\ub85c \ud574\uacb0\ud574\ubcf4\uc790!","description":"\uc778\ud504\ub7f0\uc5d0\uc11c \uc2e4\uc2b5\uc73c\ub85c \ubc30\uc6b0\ub294 \uc120\ucc29\uc21c \uc774\ubca4\ud2b8 \uc2dc\uc2a4\ud15c\uc774\ub77c\ub294 \uc7ac\ubc0c\ub294 \uac15\uc758\uac00 \uc788\uc5b4\uc11c \uc9c4\ud589\ud574 \ubcf4\uc558\ub2e4. \ucee4\ub9ac\ud058\ub7fc\uc744 \ubcf4\ub2c8\uae4c Redis\uc640 Kafka\ub97c \uc0ac\uc6a9\ud574\uc11c \uc9c4\ud589\ud558\ub294\ub370 Redis\ub294 \uadf8\ub807\ub2e4 \uce58\uace0, Kafka\ub294 \ub530\ub85c \uc0ac\uc6a9\ud574 \ubcf8 \uc801\uc774 \uc5c6\uc5b4\uc11c \uac04\ub2e8\ud558\uac8c \uacbd\ud5d8\ud558\uae30 \uc704\ud574 \uc9c4\ud589\ud588\ub2e4.","date":"2024-01-04T00:00:00.000Z","formattedDate":"2024\ub144 1\uc6d4 4\uc77c","tags":[{"label":"\uac1c\ubc1c","permalink":"/dev/tags/\uac1c\ubc1c"}],"readingTime":13.546666666666667,"hasTruncateMarker":false,"authors":[{"name":"Juhyeon Oh","title":"Backend Developer","url":"https://github.com/ohju96","imageURL":"https://github.com/ohju96.png","key":"me"}],"frontMatter":{"slug":"2","title":"\uc120\ucc29\uc21c \uc774\ubca4\ud2b8\ub97c Redis\uc640 Kafka\ub85c \ud574\uacb0\ud574\ubcf4\uc790!","authors":"me","tags":["\uac1c\ubc1c"]},"unlisted":false,"nextItem":{"title":"\ud2b8\ub79c\uc7ad\uc158\uc774 \uc774\uc0c1\ud574\uc694..(feat. \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900, Isolation Level)","permalink":"/dev/1"}},"content":"\uc778\ud504\ub7f0\uc5d0\uc11c [\uc2e4\uc2b5\uc73c\ub85c \ubc30\uc6b0\ub294 \uc120\ucc29\uc21c \uc774\ubca4\ud2b8 \uc2dc\uc2a4\ud15c](https://www.inflearn.com/course/%EC%84%A0%EC%B0%A9%EC%88%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%8B%A4%EC%8A%B5/dashboard)\uc774\ub77c\ub294 \uc7ac\ubc0c\ub294 \uac15\uc758\uac00 \uc788\uc5b4\uc11c \uc9c4\ud589\ud574 \ubcf4\uc558\ub2e4. \ucee4\ub9ac\ud058\ub7fc\uc744 \ubcf4\ub2c8\uae4c Redis\uc640 Kafka\ub97c \uc0ac\uc6a9\ud574\uc11c \uc9c4\ud589\ud558\ub294\ub370 Redis\ub294 \uadf8\ub807\ub2e4 \uce58\uace0, Kafka\ub294 \ub530\ub85c \uc0ac\uc6a9\ud574 \ubcf8 \uc801\uc774 \uc5c6\uc5b4\uc11c \uac04\ub2e8\ud558\uac8c \uacbd\ud5d8\ud558\uae30 \uc704\ud574 \uc9c4\ud589\ud588\ub2e4.\\n\\n[\ucd5c\uc0c1\uc6a9](https://www.inflearn.com/users/209585) \uac15\uc0ac\ub2d8\uc758 \uac15\uc758\uc778\ub370 \uc774\ubd84 \uac15\uc758\ub294 \uc2ac\uca4d\uc2ac\uca4d \uc54c\uc74c\uc54c\uc74c \ub9db\ubcf4\uae30 \uc88b\uc740 \uac15\uc758\uc778 \uac83 \uac19\ub2e4. \uc7ac\uace0 \uc2dc\uc2a4\ud15c\uc744 \uad6c\ud604\ud558\uba74\uc11c \ub3d9\uc2dc\uc131\uc744 \ud574\uacb0\ud558\ub294 \uac15\uc758\ub3c4 \uc774\uc804\uc5d0 \ub4e4\uc5c8\ub294\ub370 \ub2e4\uc2dc \ub4e4\uc5b4\ubcf4\uba74\uc11c \uc815\ub9ac\ud574 \ubcfc \uc608\uc815\uc774\ub2e4.\\n\\n\uc774 \uae00\uc5d0\uc11c \uc804\uccb4 \ucf54\ub4dc\ub97c \ubcf4\uc5ec\uc8fc\uc9c4 \uc54a\uc73c\ub2c8 \uad81\uae08\ud55c \uc0ac\ub78c\uc740 \ud574\ub2f9 \uac15\uc758\ub97c \ub4e4\uc5b4\ubcf4\ub294 \uac83\uc744 \ucd94\ucc9c\ud55c\ub2e4. \uc778\ud504\ub7f0\uc774 \ud560\uc778\uc744 \uc790\uc8fc\ud574\uc11c \ub300\ucda9 20\ud37c \ud560\uc778\ud560 \ub54c \uad6c\ub9e4\ud558\uba74 \uc815\uac00\uc778 \ub290\ub08c\uc774\ub2e4.(\uc815\uac00\uac00 \uc544\uae4c\uc6b4 \uac15\uc758\ub294 \uc544\ub2c8\ub2e4.)\\n\\n## Docker\uc640 MySQL\\n\\n### 1. Docker \uc124\uce58 \ubc0f \uc14b\ud305\\n\\n```bash\\nbrew install docker\\nbrew link docker\\ndocker version\\n```\\n\ub9e5\ubd81\uc73c\ub85c \uc2e4\uc2b5\uc744 \uc9c4\ud589\ud588\ub2e4. \ud328\ud0a4\uc9c0 \uad00\ub9ac\uc790\uc778 brew\ub97c \ud1b5\ud574 docker\ub97c \uc124\uce58\ud558\ub294 \uac83 \ubd80\ud130 \uc2dc\uc791\ud55c\ub2e4.\\n\\n```bash\\ndocker pull mysql\\n```\\n\uc2e4\uc2b5\uc5d0\uc11c \uae30\ubcf8\uc801\uc73c\ub85c MySQL\uc744 \uc0ac\uc6a9\ud55c\ub2e4. MySQL\uc758 Image\ub97c \uac00\uc838\uc628\ub2e4. \uc774\ub54c \ubc84\uc804\uc744 \uae30\ub85d\ud558\uc9c0 \uc54a\uc73c\uba74 \uc790\ub3d9\uc73c\ub85c Latest \ubc84\uc804\uc744 \uac00\uc838\uc624\uac8c \ub41c\ub2e4.\\n\\n```bash\\ndocker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=1234 --name mysql mysql\\ndocker ps\\ndocker exec -it mysql\\n```\\nMySQL \ucee8\ud14c\uc774\ub108\ub97c \uc0dd\uc131\ud574 \uc8fc\uace0 \uc2e4\ud589\uc2dc\ucf1c \uc900\ub2e4.\\n\\n### 2. MySQL \uc5f0\ub3d9\uacfc \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc14b\ud305\\n\\n```bash\\nmysql -u root -p\\n```\\n\uc704\uc5d0\uc11c \uc2e4\ud589\ud55c \ucee8\ud14c\uc774\ub108\uc5d0\uc11c MySQL\uc5d0 \uc811\uc18d\ud574 \uc900\ub2e4. \uc554\ud638\ub294 \uc704\uc5d0\uc11c \uc124\uc815\ud55c `1234`\ub97c \ucc38\uace0\ud55c\ub2e4.\\n\\n```sql\\nCREATE DATABASE coupon_example;\\nUSE coupon_example;\\n```\\ncoupon_example \ub370\uc774\ud130\ubca0\uc774\uc2a4\ub97c \uc0dd\uc131\ud558\uace0 \uba54\uc778 \ub370\uc774\ud130\ubca0\uc774\uc2a4\ub85c \uc124\uc815\ud574 \uc900\ub2e4.\\n\\n```java\\nspring:\\n  jpa:\\n    hibernate:\\n      ddl-auto: create\\n    show-sql: true\\n  datasource:\\n    driver-class-name: com.mysql.cj.jdbc.Driver\\n    url: jdbc:mysql://127.0.0.1:3306/coupon_example\\n    username: root\\n    password: 1234\\n```\\nSpring \ud504\ub85c\uc81d\ud2b8\uc5d0 application.yml \ud30c\uc77c\uc5d0 \uc704\uc640 \uac19\uc774 \uc811\uc18d \uc815\ubcf4\ub97c \uc124\uc815\ud574 \uc8fc\uba74 \uae30\ucd08 \uacf5\uc0ac\ub294 \ub05d\ub098\uac8c \ub41c\ub2e4.\\n\\n## \uc694\uad6c\uc0ac\ud56d\\n\\n>\uc120\ucc29\uc21c 100\uba85\uc5d0\uac8c \ud560\uc778 \ucfe0\ud3f0\uc744 \uc81c\uacf5\ud558\ub294 \uc774\ubca4\ud2b8 \uc9c4\ud589\\n> 1. \uc120\ucc29\uc21c 100\uba85\ub9cc \uc9c0\uae09.\\n> 2. 101\uac1c \uc9c0\uae09\uc740 \uc548 \ub428.\\n> 3. \uc21c\uac04\uc801\uc73c\ub85c \ubab0\ub9ac\ub294 \ud2b8\ub798\ud53d\uc744 \ubc84\ud168\uc57c \ud55c\ub2e4.\\n\\n## \ucd08\uae30 \ub85c\uc9c1 \uad6c\ud604 \ubc0f \ud14c\uc2a4\ud2b8\\n\\n### 1. \ucfe0\ud3f0 \uc0dd\uc131 \ub85c\uc9c1\\n\\n```java\\npublic void apply(Long userId) {\\n    long count = couponRepository.count();\\n\\n    if (count > 100) {\\n        return;\\n    }\\n\\n    couponRepository.save(new Coupon(userId));\\n}\\n```\\n\ucfe0\ud3f0\uc758 \uac1c\uc218\ub97c \ud655\uc778\ud558\uace0 \uac1c\uc218\uac00 100\uac1c\ub97c \ub118\uc5c8\uc744 \ub54c \uadf8\ub0e5 \ub9ac\ud134\ud574 \uc900\ub2e4. 100\uac1c\uac00 \ub118\uc9c0 \uc54a\uc558\uc744 \uacbd\uc6b0 \ucfe0\ud3f0\uc744 \uc0dd\uc131\ud574\uc11c \uc800\uc7a5\ud558\ub294 \uac04\ub2e8\ud55c \ub85c\uc9c1\uc73c\ub85c \ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud55c\ub2e4.\\n\\n### 2. \ud14c\uc2a4\ud2b8 \ucf54\ub4dc \uc791\uc131\\n\\n```java\\n@Test\\npublic void \ud55c\ubc88\ub9cc\uc751\ubaa8() {\\n    applyService.apply(1L);\\n\\n    long count = couponRepository.count();\\n\\n    assertThat(count).isEqualTo(1);\\n}\\n```\\n\uac04\ub2e8\ud558\uac8c \uc9c4\ud589\ud558\uba74 \uc815\uc0c1\uc801\uc73c\ub85c \uc751\ubaa8\uac00 \ub418\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.\\n\\n## \ucd08\uae30 \ub85c\uc9c1\uc758 \ubb38\uc81c \ubc1c\uad74\\n\\n\ucd08\uae30 \ub85c\uc9c1\uc774 \ud14c\uc2a4\ud2b8 \ucf54\ub4dc\ub97c \uc131\uacf5\ud558\uba74\uc11c \uc815\uc0c1\uc801\uc73c\ub85c \uc2e4\ud589\uc774 \ub418\uc5c8\ub2e4\uace0 \uc624\ud574\ud560 \uc218\ub3c4 \uc788\ub2e4. \ud558\uc9c0\ub9cc \ucfe0\ud3f0 \ubc1c\uae09 \uc774\ubca4\ud2b8\ub294 \ub3d9\uc2dc\uc5d0 \uc5ec\ub7ec\ubc88 \uc2e4\ud589\uc774 \ub420 \uac83\uc774\ub2e4. \uc774\ub7f0 \uc0c1\ud669\uc744 \uac00\uc815\ud574\uc11c \uc2e4\ud589\ud558\uba74 \ubb38\uc81c\uac00 \ub098\ud0c0\ub09c\ub2e4.\\n\\n### 1. \ud14c\uc2a4\ud2b8 \ucf54\ub4dc\\n\\n```java\\n@Test\\npublic void \uc5ec\ub7ec\uba85\uc751\ubaa8() throws InterruptedException {\\n    int threadCount = 1000;\\n    ExecutorService executorService = Executors.newFixedThreadPool(32);\\n    CountDownLatch latch = new CountDownLatch(threadCount);\\n\\n    for (int i = 0; i < threadCount; i++) {\\n        long userId = i;\\n        executorService.submit(() -> {\\n           try {\\n               applyService.apply(userId);\\n           } finally {\\n               latch.countDown();\\n           };\\n        });\\n    }\\n    latch.await();\\n\\n    long count = couponRepository.count();\\n\\n    assertThat(count).isEqualTo(100);\\n}\\n```\\n\uc5ec\ub7ec \uac1c\uc758 \uc2a4\ub808\ub4dc\ub85c \ucfe0\ud3f0\uc744 \ubc1c\uae09\ud574 \ubcf4\ub294 \ud14c\uc2a4\ud2b8 \ucf54\ub4dc\uc774\ub2e4. \ud574\ub2f9 \ucf54\ub4dc\ub97c \uc2e4\ud589\ud574 \ubcf4\uba74\\n\\n![01.png](img%2F01.png)\\n\ubb38\uc81c\uac00 \ubc1c\uc0dd\ud55c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.\\n\\n### 2. \ubb38\uc81c\ub294 \ub808\uc774\uc2a4 \ucee8\ub514\uc158(Race condition)\\n\\n\ub808\uc774\uc2a4 \ucee8\ub514\uc158\uc740 \ub450 \uac1c \uc774\uc0c1\uc758 \uc2a4\ub808\ub4dc\uac00 \uacf5\uc720 \uc790\uc6d0\uc5d0 \uc5d1\uc138\uc2a4\ud558\uace0 \ud65c\uc6a9\ud558\ub824\uace0 \ud560 \ub54c \uc0dd\uae30\ub294 \ubb38\uc81c\ub85c \uc704\uc5d0\uc11c\ub294 99\uac1c\uc758 \ucfe0\ud3f0\uc774 \uc788\uc744 \ub54c \ub3d9\uc2dc\uc5d0 \uc5ec\ub7ec \uc2a4\ub808\ub4dc\uac00 99\uac1c\uc784\uc744 \uc778\uc9c0\ud558\uace0 \ucfe0\ud3f0\uc744 \ubc1c\uae09\ud574\uc11c \uc0dd\uae30\ub294 \ubb38\uc81c\uc774\ub2e4.\\n\\n\uc774\ub7f0 \uc0c1\ud669\uc744 \uc774\uc804\uc5d0 \ud68c\uc0ac\uc5d0\uc11c \uacb0\uc81c\uc640 \uc7ac\uace0 \ucc98\ub9ac\ub85c\uc9c1 \uc791\uc131\ud558\uba74\uc11c \uacaa\uc740 \uc801\uc774 \uc788\uc5c8\ub294\ub370 \ubba4\ud14d\uc2a4\ub97c \uc0ac\uc6a9\ud574\uc11c \ucc98\ub9ac\ud588\uc5c8\ub2e4.\\n\\n\ud558\uc9c0\ub9cc \ubba4\ud14d\uc2a4\ub098 \uc138\ub9c8\ud3ec\uc5b4\ub97c \uc0ac\uc6a9\ud55c \ubc29\ubc95 \ub9d0\uace0\ub3c4 \uc5ec\ub7ec \ubc29\ubc95\uc774 \uc788\ub294\ub370 Redis\ub97c \uc0ac\uc6a9\ud574\uc11c \uba3c\uc800 \ud574\uacb0\ud574 \ubcf8\ub2e4.\\n\\n## Redis\ub85c \ub808\uc774\uc2a4 \ucee8\ub514\uc158 \ud574\uacb0\ud558\uae30\\n\\n### 1. Redis setting\\n\\n```bash\\ndocker pull redis\\ndocker run --name myredis -d -p 6379:6379 redis\\n```\\n\uc704\uc5d0\uc11c MySQL\uc744 \uc14b\ud305\ud588\uc744 \ub54c\uc640 \ub9c8\ucc2c\uac00\uc9c0\ub85c Redis Image\ub97c Latest\ub85c \uac00\uc838\uc624\uace0 \ucee8\ud14c\uc774\ub108\ub97c \uc0dd\uc131\ud558\uace0 \uc2e4\ud589\ud574 \uc900\ub2e4.\\n\\n```java\\nimplementation \'org.springframework.boot:spring-boot-starter-data-redis\'\\n```\\nSpring\uc5d0\uc11c \uc758\uc874\uc131\ub3c4 \ucd94\uac00\ud574 \uc900\ub2e4.\\n\\napplication.yml\uc740 Redis\ub97c \uc0dd\uc131\ud560 \ub54c \ub530\ub85c \uc0ac\uc6a9\uc790 \uc124\uc815\uc744 \ud558\uc9c0 \uc54a\uc558\uae30 \ub54c\ubb38\uc5d0 \uc704 \uc758\uc874\uc131\uc744 \ucd94\uac00\ud558\uba74 \uc54c\uc544\uc11c \ub514\ud3f4\ud2b8\ub85c \uc5f0\uacb0\ud574 \uc900\ub2e4.\\n\\n\ub530\ub77c\uc11c \ub530\ub85c \uc124\uc815\ud558\uc9c0 \uc54a\uc544\ub3c4 Spring\uc5d0\uc11c local\uc5d0\uc11c \uc2e4\ud589\ud558\ub294 Redis\uc5d0 \uc811\uc18d\ud560 \uc218 \uc788\ub2e4.\\n\\n### 2. Redis\ub85c \ud574\uacb0\ud558\ub824\ub294 \uc774\uc720\\n\\nLock\uc744 \uc0ac\uc6a9\ud558\uba74 \uc0dd\uc131\ud558\ub294 \ub85c\uc9c1\ubd80\ud130 \ubc1c\uae09\ud558\ub294 \ub85c\uc9c1\uae4c\uc9c0 Lock\uc744 \uac78\uc5b4\uc57c \ud55c\ub2e4. \ub54c\ubb38\uc5d0 \uc131\ub2a5\uc5d0 \ubd88\uc774\uc775\uc774 \uc788\ub2e4. \ub610\ud55c synchronized\ub97c \uc0ac\uc6a9\ud558\uac8c \ub418\uba74 \ub9c8\ucc2c\uac00\uc9c0\ub85c \uc131\ub2a5 \uc800\ud558\uac00 \uc0dd\uae38 \uc218 \uc788\uace0 \uc11c\ubc84\uac00 \ub298\uc5b4\ub0ac\uc744 \ub54c \uc18c\uc6a9 \uc5c6\uac8c \ub41c\ub2e4.\\n\\n\uc120\ucc29\uc21c \uc774\ubca4\ud2b8\ub294 \ucfe0\ud3f0 \uac1c\uc218\uc5d0 \ub300\ud55c \uc815\ud569\uc131\uc774 \uc911\uc694\ud558\ub2e4. Redis\ub97c \uc0ac\uc6a9\ud558\ub294 \uc774\uc720\ub294 Redis\uc5d0\uc11c \uc9c0\uc6d0\ud558\ub294 `incr`\uc774\ub77c\ub294 \uc608\uc57d\uc5b4\uac00 \uc788\ub294\ub370 \uc774\ub294 Key\uc5d0 \ub300\ud55c Value\ub97c 1\uc529 \uc99d\uac00\ud0a4\uc2e0\ub2e4.\\n\\n\uae30\ubcf8\uc801\uc73c\ub85c Redis\ub294 Single-Thread \uae30\ubc18\uc73c\ub85c \ub3d9\uc791\ud558\uae30 \ub54c\ubb38\uc5d0 \ubb38\uc81c\ub3c4 \uc5c6\uace0 `incr` \uc790\uccb4\uc758 \uc131\ub2a5\ub3c4 \uc88b\uc544 \uc815\ud569\uc131\uc744 \uc9c0\ud0a4\ub294\ub370 \ubb38\uc81c\uac00 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \uc0ac\uc6a9\ud558\uae30 \uc801\ub2f9\ud558\ub2e4 \ud560 \uc218 \uc788\ub2e4.\\n\\n### 3. incr \ud14c\uc2a4\ud2b8\\n\\n```bash\\ndocker exec -it \ucee8\ud14c\uc774\ub108ID redis-cli\\n```\\nRedis\ub97c \uc2e4\ud589\ud558\uace0\\n\\n```redis\\nincr coupon_count\\nincr coupon_count\\n```\\n`incr` \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uba74 1\uc529 \ubca8\ub958\uac00 \uc99d\uac00\ud558\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.\\n\\n### 4. Repository \ucf54\ub4dc\\n\\n```java\\npublic long increment() {\\n    return redisTemplate\\n            .opsForValue()\\n            .increment(\\"couponCount\\");\\n}\\n```\\nRepository\uc5d0 RedisTemplate\uc744 \uc0ac\uc6a9\ud574\uc11c \ucf54\ub4dc\ub97c \uc791\uc131\ud574\uc8fc\uace0 \ud14c\uc2a4\ud2b8 \ucf54\ub4dc\ub97c \uc2e4\ud589\ud558\uba74 \ud1b5\uacfc\ud558\uac8c \ub41c\ub2e4.\\n\\n\uc774\ub294 Single-Thread\uc778 Redis\uc5d0\uc11c \uc22b\uc790\ub97c \uce74\uc6b4\ud305\ud558\uae30 \ub54c\ubb38\uc5d0 \uac01 \uc2a4\ub808\ub4dc\ub4e4\uc774 \uac00\uc838\uac00\ub294 \uc22b\uc790\uac00 \uacb9\uce58\uc9c0 \uc54a\uac8c \ub418\uc5b4 \ub808\uc774\uc2a4 \ucee8\ub514\uc158\uc774 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\uac8c \ub418\ub294 \uac83\uc774\ub2e4.\\n\\n### 5. Redis\ub97c \uc0ac\uc6a9\ud55c \ub808\uc774\uc2a4 \ucee8\ub514\uc158 \ud574\uacb0\uc758 \ubb38\uc81c\\nRedis \uc790\uccb4\uc5d0 \ubb38\uc81c\uac00 \uc788\uae30 \ubcf4\ub2e4\ub294 Redis\ub97c \ud1b5\ud574 \ubc1c\uae09 \uc218\ub7c9\uc744 \uccb4\ud06c\ud558\uace0 \uacb0\uad6d \uc800\uc7a5\uc740 RDB\uc5d0 \ub41c\ub2e4. \ub54c\ubb38\uc5d0 \ucfe0\ud3f0\uc774 \ub9ce\uc744\uc218\ub85d RDB\uc5d0 \ubd80\ud558\ub97c \uc8fc\uac8c \ub41c\ub2e4. \uc774\ub54c, RDB\uac00 \ucfe0\ud3f0 \uc804\uc6a9\uc774 \uc544\ub2c8\ub77c \uacf5\ud1b5\uc801\uc73c\ub85c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 \ub354 \ud070 \ubb38\uc81c\uac00 \uc0dd\uae38 \uc218 \uc788\ub2e4.\\n\\n\uadf8\ub7fc \uc5b4\ub5bb\uac8c \ud558\ub098? Kafka\ub97c \uc0ac\uc6a9\ud574\uc11c \uc774 \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\ub2e4.\\n\\n## Kafka\ub97c \uc0ac\uc6a9\ud574\uc11c Redis\uc758 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uc790\\n\\n### 1. Kafka\uac00 \ubb34\uc5c7\uc778\uac00?\\n\\nKafka\ub294 \ubd84\uc0b0 \uc774\ubca4\ud2b8 \uc2a4\ud2b8\ub9ac\ubc0d \ud50c\ub7ab\ud3fc\uc73c\ub85c \uc774\ubca4\ud2b8 \uc2a4\ud2b8\ub9ac\ubc0d\uc740 \uc18c\uc2a4\uc5d0\uc11c \ubaa9\uc801\uc9c0\uae4c\uc9c0 \uc774\ubca4\ud2b8\ub97c \uc2e4\uc2dc\uac04\uc73c\ub85c \uc2a4\ud2b8\ub9ac\ubc0d\ud558\ub294 \uac83\uc744 \ub9d0\ud55c\ub2e4.\\n\\nKafka\ub294 Pub/Sub \ubaa8\ub378 \uae30\ubc18\uc758 \uba54\uc2dc\uc9c0 \ud050\uc778\ub370 \uc774 Pub/Sub\uc740 \uba54\uc2dc\uc9c0\ub97c \uc0dd\uc131\ud558\ub294 \uc11c\ube44\uc2a4\ub97c \ud574\ub2f9 \uba54\uc2dc\uc9c0\ub97c \ucc98\ub9ac\ud558\ub294 \uc11c\ube44\uc2a4\uc5d0\uc11c \ubd84\ub9ac\ud558\ub294 \ud655\uc7a5 \uac00\ub2a5\ud55c \ube44\ub3d9\uae30 \uba54\uc2dc\uc9d5 \uc11c\ube44\uc2a4\uc774\ub2e4.\\n\\n\uac04\ub2e8\ud558\uac8c \uc124\uba85\ud558\uba74 \uac8c\uc2dc\uc790 \ubc0f \uad6c\ub3c5\uc790\ub77c\ub294 \uc758\ubbf8\ub97c \ud1b5\ud574 \uac8c\uc2dc\uc790\uac00 \uc774\ubca4\ud2b8\ub97c \uc0dd\uc131\ud558\uba74 \uac19\uc740 \uacf3\uc744 \ubc14\ub77c\ubcf4\uace0 \uc788\ub294 \uad6c\ub3c5\uc790\ub294 \ud574\ub2f9 \uc774\ubca4\ud2b8\uac00 \uc0dd\uc131 \ub428\uc744 \uc54c \uc218 \uc788\uac8c \ub418\ub294 \uac83\uc774\ub2e4.\\n\\n\uc5ec\uae30\uc5d0\uc11c\ub294 \uac8c\uc2dc\uc790 \ubc0f \uad6c\ub3c5\uc790\ub97c Producer\uc640 Consumer\ub85c \ud45c\ud604\ud558\uace0 \ubc1c\uc0dd\ud558\ub294 \uc774\ubca4\ud2b8\ub97c \ubc14\ub77c\ubcf4\ub294 \ud1b5\ub85c\ub97c Topic\uc774\ub77c\uace0 \ubcf4\uaca0\ub2e4. \ub530\ub77c\uc11c `Producer -> Topic <- Consumer`\ub85c \uad6c\uc131\ub418\uc5b4 \ub3d9\uc791\ud55c\ub2e4\uace0 \ubcf4\uba74 \ub41c\ub2e4. \uc774\ub54c Topic\uc740 Queue \uac19\uc740 \ud1b5\ub85c\ub85c \ubcf4\uba74 \ub418\uace0 \ub370\uc774\ud130 \uc0bd\uc785\uc740 Producer\uc5d0 \uc758\ud574\uc11c, \ub370\uc774\ud130 \uc18c\ube44\ub294 Consumer\uc5d0 \uc758\ud574\uc11c \uc9c4\ud589\ub41c\ub2e4.\\n\\n\uadf8\ub7fc \uc774\uc81c \uac04\ub2e8\ud558\uac8c Kafka\ub97c \uc14b\ud305\ud558\uace0 \ud14c\uc2a4\ud2b8 \ud574 \ubcf4\uc790.\\n\\n### 2. Kafka \uc14b\ud305\\n\\n```bash\\nversion: \'2\'\\nservices:\\n  zookeeper:\\n    image: wurstmeister/zookeeper\\n    container_name: zookeeper\\n    ports:\\n      - \\"2181:2181\\"\\n  kafka:\\n    image: wurstmeister/kafka:2.12-2.5.0\\n    container_name: kafka\\n    ports:\\n      - \\"9092:9092\\"\\n    environment:\\n      KAFKA_ADVERTISED_HOST_NAME: 127.0.0.1\\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\\n    volumes:\\n      - /var/run/docker.sock:/var/run/docker.sock\\n```\\nSpring\uc5d0 docker-compose.yml\uc744 \uc0dd\uc131\ud574\uc11c \uc704\uc640 \uac19\uc774 \uc791\uc131\ud574 \uc900\ub2e4.\\n\\n```bash\\ndocker-compose up -d\\ndocker-compose down\\n```\\n\uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \uc791\uc131\ud55c docker-compose \ud30c\uc77c\uc744 \uc2e4\ud589\ud558\uace0 \uc885\ub8cc\ud55c\ub2e4. \uc2e4\ud589 \ud6c4\uc5d0\ub294 `docker ps` \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \uc2e4\ud589\uc774 \uc815\uc0c1\uc801\uc73c\ub85c \ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud55c\ub2e4.\\n\\n### 3. Kafka \ud14c\uc2a4\ud2b8\\n\\n```bash\\ndocker exec -it kafka kafka-topics.sh --bootstrap-server localhost:9092 --create --topic testTopic\\n```\\n`testTopic`\uc774\ub77c\ub294 Topic\uc744 \uc0dd\uc131\ud55c\ub2e4. \ub9d0 \uadf8\ub300\ub85c \ud14c\uc2a4\ud2b8\uc6a9\uc774\ub2e4. \uc0dd\uc131\uc774 \uc644\ub8cc\ub418\uba74 `Created topic testTopic.`\ub77c\ub294 \ubb38\uad6c\uac00 \ub728\uac8c \ub41c\ub2e4.\\n\\n```bash\\ndocker exec -it kafka kafka-console-producer.sh --topic testTopic --broker-list 0.0.0.0:9092\\n```\\n\uc774\uc81c Topic\uc744 \uc0bd\uc785\ud560 Producer\ub97c \uc2e4\ud589\ud574 \uc900\ub2e4.\\n\\n```bash\\ndocker exec -it kafka kafka-console-consumer.sh --topic testTopic --bootstrap-server 0.0.0.0:9092\\n```\\n\ub9c8\uc9c0\ub9c9\uc73c\ub85c Consumer\ub97c \uc0dd\uc131\ud574 \uc918\uc57c \ud558\ub294\ub370 Producer\ub97c \uc2e4\ud589\ud55c \ud130\ubbf8\ub110\uc744 \ub194\ub450\uace0 \uc0c8\ub85c\uc6b4 \ud130\ubbf8\ub110\uc744 \uc5f4\uc5b4\uc8fc\uc5b4 \ud574\ub2f9 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud55c\ub2e4.\\n\\n![02.png](img%2F02.png)\\n\uc774\ud6c4 Producer\uc5d0\uc11c `hello`\ub97c \uc785\ub825\ud558\uba74 \uac19\uc740 Topic\uc744 \ubc14\ub77c\ubcf4\ub358 Consumer\uac00 \ub370\uc774\ud130\ub97c \uac00\uc838\uc640 \ucd9c\ub825\ud558\uac8c \ub41c\ub2e4. \uc774\uc81c \ud14c\uc2a4\ud2b8\ub294 \ub05d\ub0ac\ub2e4 Kafka \uad6c\ud604\uc5d0 \ub4e4\uc5b4\uac04\ub2e4.\\n\\n## Kafka Producer \uad6c\ud604\ud558\uae30\\n\\n### 1. \uc758\uc874\uc131 \ucd94\uac00 \ubc0f config \uc791\uc131\\n\\n```java\\nimplementation \'org.springframework.kafka:spring-kafka\'\\n```\\nSpring\uc5d0 Kafka \uc758\uc874\uc131\uc744 \ucd94\uac00\ud574 \uc900\ub2e4.\\n\\n```java\\n@Configuration\\npublic class KafkaProducerConfig {\\n\\n    @Bean\\n    public ProducerFactory<String, Long> producerFactory() {\\n        Map<String, Object> config = new HashMap<>();\\n\\n        config.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \\"localhost:9092\\");\\n        config.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);\\n        config.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, LongSerializer.class);\\n\\n        return new DefaultKafkaProducerFactory<>(config);\\n    }\\n\\n    @Bean\\n    public KafkaTemplate<String, Long> kafkaTemplate() {\\n        return new KafkaTemplate<>(producerFactory());\\n    }\\n\\n}\\n```\\nKafkaProducerConfig.java\ub97c \uc791\uc131\ud574 \uc8fc\uace0\\n\\n```java\\n@Component\\npublic class CouponCreateProducer {\\n\\n    private final KafkaTemplate<String, Long> kafkaTemplate;\\n\\n    public CouponCreateProducer(KafkaTemplate<String, Long> kafkaTemplate) {\\n        this.kafkaTemplate = kafkaTemplate;\\n    }\\n\\n    public void create(Long userId) {\\n        kafkaTemplate.send(\\"coupon_create\\", userId);\\n    }\\n}\\n```\\nProducer\uac00 \ubcf4\ub0bc Topic\uc744 \uc9c0\uc815\ud574 \uc900\ub2e4. `coupon_create`\ub85c \uc124\uc815\ud574 \uc8fc\uc5c8\ub2e4.\\n\\n```java\\npublic void apply(Long userId) {\\n\\n//        long count = couponRepository.count();\\nlong count = couponCountRepository.increment();\\n\\n        if (count > 100) {\\n            return;\\n        }\\n\\n//        couponRepository.save(new Coupon(userId));\\ncouponCreateProducer.create(userId);\\n}\\n```\\nService \ub85c\uc9c1\uc5d0\uc11c RDB\uc5d0 \uc800\uc7a5\ud558\uc9c0 \uc54a\uace0 Producer\ub97c \uac70\uce58\ub3c4\ub85d \ubcc0\uacbd\ud574\uc900\ub2e4. (\ucd94\ud6c4\uc5d0 \ubcc0\uacbd\ud560 \uc608\uc815\uc774\ub2c8 \uc77c\ub2e8\uc744 \uc774\ub807\uac8c \ud55c\ub2e4.)\\n\\n### 2. Topic \ubc0f Consumer \uc0dd\uc131\\n\\n```bash\\ndocker exec -it kafka kafka-topics.sh --bootstrap-server localhost:9092 --create --topic coupon_create\\n```\\n\ud130\ubbf8\ub110\uc744 \uc5f4\uc5b4 `coupon_create`\ub77c\ub294 Topic\uc744 \uc0dd\uc131\ud574 \uc8fc\uace0\\n\\n```bash\\ndocker exec -it kafka kafka-console-consumer.sh --topic coupon_create --bootstrap-server localhost:9092 --key-deserializer \\"org.apache.kafka.common.serialization.StringDeserializer\\" --value-deserializer \\"org.apache.kafka.common.serialization.LongDeserializer\\"\\n```\\nConsumer\ub3c4 \uc0dd\uc131\ud574 \uc900\ub2e4.\\n\\n### 3. \ud14c\uc2a4\ud2b8 \uc2e4\ud589\\n\\n![03.png](img%2F03.png)\\n\ud14c\uc2a4\ud2b8 \ucf54\ub4dc\ub294 \uc2e4\ud328\ud588\ub2e4. \uc65c\ub0d0\ud558\uba74 \uc704\uc5d0\uc11c RDB\uc5d0 \uc800\uc7a5\ub418\ub294 \ubd80\ubd84\uc744 \uc9c0\uc6b0\uace0 Producer\ub97c \uac70\uccd0 \uac8c\uc2dc\ud558\uace0 \uc788\ub294 Topic\uc5d0 \ub370\uc774\ud130\ub97c \ubcf4\ub0b4\uc8fc\uc5c8\uae30 \ub54c\ubb38\uc774\ub2e4.\\n\\n\uc704\uc5d0 \ud130\ubbf8\ub110\uc744 \ubcf4\uba74 \ubb34\uc218\ud55c \uac12\ub4e4\uc774 \ud45c\ud604\ub418\uace0 \uc788\ub2e4. \uc774\ub294 Consumer\ub97c \uc2e4\ud589\ud55c \ud130\ubbf8\ub110 \ucc3d\uc73c\ub85c Producer\uac00 \ubc1c\uc0dd\uc2dc\ud0a8 \uc774\ubca4\ud2b8\ub97c \uc798 \ubc1b\uace0 \uc788\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.\\n\\n\uc774\ub807\uac8c Producer\uc758 \uc5ed\ud560\uc740 \ub05d\ub0ac\ub2e4. \uc774\uc81c Consumer\ub97c \uad6c\ud604\ud574\ubcf4\uc790.\\n\\n## Kafka Consumer \uad6c\ud604\ud558\uae30\\n\\n### 1. \uc0c8\ub85c\uc6b4 \ud504\ub85c\uc81d\ud2b8\\n\\n\uc774 \ud504\ub85c\uc81d\ud2b8\ub294 \uba40\ud2f0\ubaa8\ub4c8\ub85c \uc124\uacc4\ub418\uc5c8\ub2e4. Consumer\ub294 \uc0c8\ub85c\uc6b4 \ud504\ub85c\uc81d\ud2b8\ub85c \uad6c\uc131\ud55c\ub2e4. \uc0c8\ub85c\uc6b4 \ud504\ub85c\uc81d\ud2b8\uc5d0 \uc8fc\uc785\ub420 \uc758\uc874\uc131\uc740 \uc544\ub798\uc640 \uac19\ub2e4.\\n\\n```java\\nimplementation \'org.springframework.boot:spring-boot-starter-data-jpa\'\\nimplementation \'org.springframework.kafka:spring-kafka\'\\nruntimeOnly \'com.mysql:mysql-connector-j\'\\n```\\napplication.yml\uc740 \uc774\uc804\uc5d0 \uc0dd\uc131\ud588\ub358 \uac83\uacfc \ub3d9\uc77c\ud558\uac8c \ub123\uc5b4\uc900\ub2e4.\\n\\n### 2. Consumer Config\\n\\n```java\\n@Configuration\\npublic class KafkaConsumerConfig {\\n\\n    @Bean\\n    public ConsumerFactory<String, Long> consumerFactory() {\\n        Map<String, Object> config = new HashMap<>();\\n\\n        config.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \\"localhost:9092\\");\\n        config.put(ConsumerConfig.GROUP_ID_CONFIG, \\"group_1\\");\\n        config.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);\\n        config.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, LongDeserializer.class);\\n\\n        return new DefaultKafkaConsumerFactory<>(config);\\n    }\\n\\n    @Bean\\n    public ConcurrentKafkaListenerContainerFactory<String, Long> kafkaListenerContainerFactory() {\\n        ConcurrentKafkaListenerContainerFactory<String, Long> factory = new ConcurrentKafkaListenerContainerFactory<>();\\n        factory.setConsumerFactory(consumerFactory());\\n\\n        return factory;\\n    }\\n}\\n```\\n\ub9c8\ucc2c\uac00\uc9c0\ub85c KafkaConsumerConfig.java\ub97c \uc791\uc131\ud55c\ub2e4.\\n\\n```java\\n@Component\\npublic class CouponCreatedConsumer {\\n\\n    @KafkaListener(topics = \\"coupon_create\\", groupId = \\"group_1\\")\\n    public void listener(Long userId) {\\n        System.out.println(\\"\ucfe0\ud3f0\uc774 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4. userId : \\" + userId);\\n    }\\n}\\n```\\n\uc704\uc5d0\uc11c Producer(\uac8c\uc2dc\uc790)\uac00 \ubc14\ub77c\ubcf4\ub294 \ud1a0\ud53d(coupon_create)\uc744 \uad6c\ub3c5\ud558\ub3c4\ub85d \uc124\uc815\ud574\uc900\ub2e4. \uac04\ub2e8\ud55c \ucd9c\ub825\uc73c\ub85c \uadf8 \uacb0\uacfc\ub97c \ud655\uc778\ud574\ubcf4\uc790.\\n\\n### 3. \ud14c\uc2a4\ud2b8 \uc2e4\ud589\\n\\n![04.png](img%2F04.png)\\nProducer\uac00 Topic\uc5d0 \uc3d8\ub294 \ub370\uc774\ud130\ub97c Consumer\uac00 \uc798 \ubc1b\uc544\uc624\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.\\n\\n### 4. RDB\uc5d0 \uc800\uc7a5\uc2dc\ud0a4\uae30\\n\\n```java\\n@Component\\npublic class CouponCreatedConsumer {\\n\\n    private final CouponRepository couponRepository;\\n\\n    public CouponCreatedConsumer(CouponRepository couponRepository) {\\n        this.couponRepository = couponRepository;\\n    }\\n\\n    @KafkaListener(topics = \\"coupon_create\\", groupId = \\"group_1\\")\\n    public void listener(Long userId) {\\n        couponRepository.save(new Coupon(userId));\\n    }\\n}\\n```\\n\uc774\uc81c \ucd9c\ub825\uc774 \uc544\ub2c8\ub77c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ud558\ub3c4\ub85d \ud55c\ub2e4.\\n\\n### 5. \ub2e4\uc2dc \ud14c\uc2a4\ud2b8\\n\\n![05.png](img%2F05.png)\\n\uc2e4\ud328\ud588\ub2e4. \uac11\uc790\uae30? \uc65c \uc2e4\ud328\ud588\uc744\uae4c? \ubc14\ub85c \ub370\uc774\ud130 \ucc98\ub9ac \uc2dc\uac04 \ucc28\uc774\uc5d0 \ub530\ub978 \uc2e4\ud328\ub77c\uace0 \ubcfc \uc218 \uc788\ub2e4.\\n\\n\uc608\ub97c \ub4e4\uc5b4 Producer\uac00 \ub370\uc774\ud130\ub97c \uc804\uc1a1\ud558\uace0 \uc644\ub8cc\ud558\uace0 \ub098\uc11c \ud14c\uc2a4\ud2b8 \ucf00\uc774\uc2a4\ub294 \uc885\ub8cc\ub41c\ub2e4. \ud558\uc9c0\ub9cc \ub370\uc774\ud130\ub294 Consumer\uac00 \ubc1b\uc544\uc11c \ucc98\ub9ac\ud55c\ub2e4. \uadf8\ub807\ub2e4. \ud14c\uc2a4\ud2b8 \ucf00\uc774\uc2a4\ub294 Consumer\uac00 \ub370\uc774\ud130\ub97c \ucc98\ub9ac\ud558\ub294 \uc2dc\uac04\uae4c\uc9c0 \uae30\ub2e4\ub9ac\uc9c0 \uc54a\uc558\uae30 \ub54c\ubb38\uc5d0 \uc0dd\uae34 \ubb38\uc81c\uc774\ub2e4.\\n\\n```java\\n...\\nlatch.await();\\n\\nThread.sleep(10000);\\n...\\n```\\n\ud14c\uc2a4\ud2b8 \ucf54\ub4dc\uc5d0 Thread sleep\uc744 \uc8fc\uc5b4 \ucda9\ubd84\ud788 Consumer\uac00 \ucc98\ub9ac\ud560 \uc218 \uc788\ub3c4\ub85d \uae30\ub2e4\ub824\uc918\ubcf4\uc790.\\n\\n![06.png](img%2F06.png)\\n\uc131\uacf5\ud588\ub2e4.\\n\\n## \uc694\uad6c\uc0ac\ud56d\uc744 \ucd94\uac00\ud574\ubcf4\uc790.\\n\\n### 1. \ucd94\uac00\ub418\ub294 \uc694\uad6c\uc0ac\ud56d\uacfc \ud574\uacb0 \ubc29\ubc95\\n\\n> \ucfe0\ud3f0 \ubc1c\uae09\uc744 1\uc778\ub2f9 1\uac1c\ub85c \uc81c\ud55c\ud55c\ub2e4.\\n\\n\uc704\uc640 \uac19\uc740 \uc694\uad6c\uc0ac\ud56d\uc744 \ucd94\uac00\ud55c\ub2e4\uace0 \uac00\uc815\ud558\uc790. \uc774\ub97c \ud574\uacb0\ud558\ub294 \ubc29\ubc95 \ub610\ud55c \uc5ec\ub7ec\uac00\uc9c0\uac00 \uc788\ub2e4. \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0\uc11c \uc720\ub2c8\ud06c\ub97c \ud65c\uc6a9\ud558\ub294 \ubc29\ubc95\ub3c4 \uc788\uace0 \ubc94\uc704 \ub77d\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95\ub3c4 \uc788\ub2e4. \uc608\ub97c \ub4e4\uba74 \uc544\ub798\uc640 \uac19\ub2e4.\\n\\n```java\\n// lock start\\n// \ucfe0\ud3f0 \ubc1c\uae09 \uc5ec\ubd80\\n// if \ubc1c\uae09 \ub418\uc5c8\ub2e4\uba74 return\\n// lock end\\n```\\n\ud558\uc9c0\ub9cc \uc774\ub7f0 \ubc94\uc704 \ub77d\uc740 \uc131\ub2a5 \uc800\ud558 \uc774\uc288\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 \ub2e4\ub978 \ubc29\ubc95\uc744 \ub5a0\uc62c\ub824\uc57c\ud55c\ub2e4. \ub9c8\uce68, Redis\uc5d0\uc11c set\uc744 \uc9c0\uc6d0\ud55c\ub2e4. \uc774\ub97c \ud1b5\ud574 \ud574\uacb0\ud574\ubcf4\uc790.\\n\\n### 3. Redis Set\\n\\n```redis\\nsadd test 1\\n```\\nRedis\ub294 sadd \ud0a4\uc6cc\ub4dc\ub97c \ud1b5\ud574 Key, Value\ub97c \uc9c0\uc815\ud560 \uc218 \uc788\ub2e4.\\n\\n### 4. \ub85c\uc9c1 \uc791\uc131\\n\\n```java\\n@Repository\\npublic class AppliedUserRepository {\\n\\n    private final RedisTemplate<String, String> redisTemplate;\\n\\n    public AppliedUserRepository(RedisTemplate<String, String> redisTemplate) {\\n        this.redisTemplate = redisTemplate;\\n    }\\n\\n    public Long add(Long userId) {\\n        return redisTemplate\\n                .opsForSet()\\n                .add(\\"applied_user\\", userId.toString());\\n    }\\n}\\n```\\nRedis set\uc744 \uc0ac\uc6a9\ud558\ub294 repository\ub97c \uc0dd\uc131\ud574 \uc900\ub2e4. `opsForSet()`\uc744 \uc0ac\uc6a9\ud558\uba74 \ub41c\ub2e4.\\n\\n```java\\npublic void apply(Long userId) {\\n        Long apply = appliedUserRepository.add(userId);\\n\\n        if (apply != 1) {\\n            return;\\n        }\\n\\n//        long count = couponRepository.count();\\n        long count = couponCountRepository.increment();\\n\\n        if (count > 100) {\\n            return;\\n        }\\n\\n//        couponRepository.save(new Coupon(userId));\\n        couponCreateProducer.create(userId);\\n    }\\n```\\nRedis set\uc5d0 userId\ub97c \uc800\uc7a5\ud558\uace0 \uc774\ubbf8 \ucfe0\ud3f0\uc774 \ubc1c\uae09\ub418\uc5b4 \uc788\ub2e4\uba74 \uadf8\ub300\ub85c return\uc744 \ud574 \uc8fc\uc5b4 1\uc778 1\uac1c \ucfe0\ud3f0 \ubc1c\uae09\uc744 \uc9c4\ud589\ud55c\ub2e4.\\n\\n### 5. \ud14c\uc2a4\ud2b8 \ucf54\ub4dc \uc791\uc131 \ubc0f \uc2e4\ud589\\n\\n```java\\n@Test\\npublic void \ud55c\uba85\ub2f9_\ud55c\uac1c\uc758\ucfe0\ud3f0\ub9cc_\ubc1c\uae09() throws InterruptedException {\\n    int threadCount = 1000;\\n    ExecutorService executorService = Executors.*newFixedThreadPool*(32);\\n    CountDownLatch latch = new CountDownLatch(threadCount);\\n\\n    for (int i = 0; i < threadCount; i++) {\\n        long userId = i;\\n        executorService.submit(() -> {\\n            try {\\n                applyService.apply(1L);\\n            } finally {\\n                latch.countDown();\\n            };\\n        });\\n    }\\n    latch.await();\\n\\n    Thread.*sleep*(10000);\\n\\n    long count = couponRepository.count();\\n\\n    *assertThat*(count).isEqualTo(1);\\n}\\n```\\n\uc0dd\uc131\ub418\ub294 userId\ub97c 1\ub85c \uace0\uc815\ud588\ub2e4. \uc0c8\ub85c \uc791\uc131\ud55c \ud14c\uc2a4\ud2b8 \ucf54\ub4dc\ub97c \uc2e4\ud589\ud574\uc11c \ud655\uc778\ud558\uc790.\\n\\n![07.png](img%2F07.png)\\nConsumer \ud130\ubbf8\ub110\uc5d0 \ub370\uc774\ud130\uac00 1\uc774 \ucd9c\ub825\ub418\uace0 \ud14c\uc2a4\ud2b8 \ucf00\uc774\uc2a4 \uc5ed\uc2dc \ud1b5\uacfc\ub41c\ub2e4. \ucc38\uace0\ub85c \uc774\uc804\uc5d0 \uc2e4\ud589 \ub0b4\uc5ed\uc774 \uc788\uae30 \ub54c\ubb38\uc5d0 Redis\uc5d0 \uc800\uc7a5\ub41c \ub370\uc774\ud130\ub97c \ub0a0\ub824\uc8fc\ub294 \uac83\uc744 \uc78a\uc9c0 \ub9d0\uc544\uc57c \ud55c\ub2e4.\\n\\n## \ubc1c\uae09 \uc2e4\ud328\ud55c \ucfe0\ud3f0\uc740 \uc5b4\ub5bb\uac8c \ucc98\ub9ac\ud558\uc9c0?\\n\\n\uadf8\ub7fc \ubc1c\uae09\uc5d0 \uc2e4\ud328\ud55c \ucfe0\ud3f0\uc740 \uc5b4\ub5bb\uac8c \ucc98\ub9ac\ud560\uae4c? \ub530\ub85c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \ubab0\uc544\uc11c \uc800\uc7a5\uc2dc\ud0a4\uace0 \ubc30\uce58 \ub4f1\uc744 \uc0ac\uc6a9\ud574 \ub2e4\uc2dc \uc9c0\uae09\ud558\ub294 \ubc29\ud5a5\uc73c\ub85c \uc218\uc815\ud560 \uc218 \uc788\ub2e4.\\n\\n### 1. \ubc1c\uae09 \uc2e4\ud328\ud55c \ucfe0\ud3f0 \uc800\uc7a5\ud558\uae30\\n\\n```java\\n@Entity\\npublic class FailedEvent {\\n\\n    @Id @GeneratedValue(strategy = GenerationType.*IDENTITY*)\\n    private Long id;\\n\\n    private Long userId;\\n\\n    public FailedEvent() {\\n    }\\n\\n    public FailedEvent(Long userId) {\\n        this.userId = userId;\\n    }\\n}\\n```\\nFailedEvent \ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud574\uc11c \ubc1c\uae09 \uc2e4\ud328\ud55c \ucfe0\ud3f0\uc744 \uc815\uc758\ud558\uace0\\n\\n```java\\n@KafkaListener(topics = \\"coupon_create\\", groupId = \\"group_1\\")\\npublic void listener(Long userId) {\\n    try {\\n        couponRepository.save(new Coupon(userId));\\n    } catch (Exception e) {\\n        logger.error(\\"failed to create coupon :: \\" + userId);\\n        failedEventRepository.save(new FailedEvent(userId));\\n    }\\n}\\n```\\n\ucfe0\ud3f0 \uc0dd\uc131\ud560 \ub54c \uc2e4\ud328\ud55c \uacbd\uc6b0 \uc2e4\ud328 \ud14c\uc774\ube14\uc5d0 \ub370\uc774\ud130\ub97c \uc313\uc544\uc900\ub2e4. \uc5ed\uc2dc \uc774\ud6c4\uc5d0 \ubc30\uce58 \ub4f1\uc744 \ub3cc\ub824 \ud574\ub2f9 \ucfe0\ud3f0\ub4e4\uc744 \ucc98\ub9ac\ud574\uc8fc\uba74 \ub41c\ub2e4."},{"id":"1","metadata":{"permalink":"/dev/1","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/23.01/2024-01-02-01-\ud2b8\ub79c\uc7ad\uc158\uaca9\ub9ac\uc218\uc900.md","source":"@site/blog/23.01/2024-01-02-01-\ud2b8\ub79c\uc7ad\uc158\uaca9\ub9ac\uc218\uc900.md","title":"\ud2b8\ub79c\uc7ad\uc158\uc774 \uc774\uc0c1\ud574\uc694..(feat. \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900, Isolation Level)","description":"\ub0b4\uac00 \uacaa\uc5b8\ub358 \ubb38\uc81c\ub4e4","date":"2024-01-02T00:00:00.000Z","formattedDate":"2024\ub144 1\uc6d4 2\uc77c","tags":[{"label":"\uac1c\ubc1c","permalink":"/dev/tags/\uac1c\ubc1c"}],"readingTime":7.473333333333334,"hasTruncateMarker":false,"authors":[{"name":"Juhyeon Oh","title":"Backend Developer","url":"https://github.com/ohju96","imageURL":"https://github.com/ohju96.png","key":"me"}],"frontMatter":{"slug":"1","title":"\ud2b8\ub79c\uc7ad\uc158\uc774 \uc774\uc0c1\ud574\uc694..(feat. \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900, Isolation Level)","authors":"me","tags":["\uac1c\ubc1c"]},"unlisted":false,"prevItem":{"title":"\uc120\ucc29\uc21c \uc774\ubca4\ud2b8\ub97c Redis\uc640 Kafka\ub85c \ud574\uacb0\ud574\ubcf4\uc790!","permalink":"/dev/2"}},"content":"## \ub0b4\uac00 \uacaa\uc5b8\ub358 \ubb38\uc81c\ub4e4\\n\uc774\uc804\uc5d0 \ud68c\uc0ac\uc5d0\uc11c \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc5d0 \uac78\ub824\uc11c \uace0\uc0dd\ud55c \uc801\uc774 \uc788\ub2e4. \uac04\ub2e8\ud55c \uc608\ub97c \ub4e4\uba74 \uc7ac\uace0\ub97c \uccb4\ud06c\ud558\ub294 \ubd80\ubd84\uc5d0\uc11c \uac78\ub838\ub294\ub370 \uc544\ub798\uc640 \uac19\ub2e4.\\n\\n```\\n1. \uc7ac\uace0 \uc870\ud68c\\n\\t2. FOR \uad6c\ub9e4\ubc18\ubcf5 {\\n\\t\\t3. \uc544\uc774\ud15c \uac2f\uc218 \uac10\uc18c\\n\\t\\t4. \uc544\uc774\ud15c \ub124\uc774\ubc0d \uc22b\uc790 \uc99d\uac00\\n\\t\\t5. \uc544\uc774\ud15c \uc0dd\uc131\\n\\t\\t6. \uc7ac\uace0 \uac10\uc18c\\n\\t\\t7. \uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8\\n\\t\\t8. \uc7ac\uace0 \uc5c5\ub370\uc774\ud2b8\\n\\t}\\n```\\n\\n\uc704\uc5d0\uc11c \uc804\uccb4 \uc7ac\uace0\ub97c \uac00\uc838\uc628\ub2e4. \uadf8\ub9ac\uace0 \uad6c\ub9e4\ub97c \ubc18\ubcf5\ud558\ub294\ub370 \uad6c\ub9e4\ud558\ub294 \ub9cc\ud07c \uc544\uc774\ud15c \uac2f\uc218\ub97c \uc904\uc5ec\uc8fc\uace0 \uc544\uc774\ud15c\uc5d0 \ubd99\ub294 \ub124\uc774\ubc0d \uc22b\uc790\ub97c \ub298\ub824\uc900 \ub2e4\uc74c \uc544\uc774\ud15c\uc744 \uc0dd\uc131\ud55c\ub2e4. \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc544\uc774\ud15c\uacfc \uc7ac\uace0\ub97c \uc5c5\ub370\uc774\ud2b8 \ud574\uc8fc\uace0 \uc0c8\ub85c\uc6b4 \ubc18\ubcf5\uc744 \uc9c4\ud589\ud55c\ub2e4.\\n\\n`\uc0c8\ub85c\uc6b4 \ubc18\ubcf5\uc744 \uc9c4\ud589\ud55c\ub2e4.`\uc5ec\uae30\uc5d0\uc11c \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud55c\ub2e4. \uac00\uc838\uc628 \uc7ac\uace0\uac00 \ub9cc\uc57d 3\uac1c\ub2e4. \uccab \ubc88\uc9f8 \ubc18\ubcf5\ubb38\uc744 \ub3cc\uba74\uc11c \uc7ac\uace0\uac00 1\uac1c \uc904\uc5b4\ub4e4\uc5c8\uc744 \ub54c \uacfc\uc5f0 \ub450 \ubc88\uc9f8 \ubc18\ubcf5\ubb38\uc740 \uadf8\uac83\uc744 \uae30\uc5b5\ud558\uace0 \uc788\uc5c8\ub098?\\n\\n\uc544\ub2c8\uc5c8\ub2e4. \uc774\uac8c \ubb54\uac00 \ud588\ub294\ub370 \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc744 \uacf5\ubd80\ud558\uba74 \uc54c \uc218 \uc788\ub294 \ubb38\uc81c\uc600\ub2e4.\\n\\n## \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900 \uc774\uc804\uc5d0 \uc54c\uc544\uc57c \ud560 \uac83\ub4e4\\n### \ud2b8\ub79c\uc7ad\uc158\\n\uadf8\ub7fc \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc740 \ubb34\uc5c7\uc77c\uae4c?\ub97c \uad81\uae08\ud574 \ud558\uae30 \uc804\uc5d0 \ud2b8\ub79c\uc7ad\uc158\uc758 \uc131\uc9c8\uc778 ACID\ub97c \uc54c\uc544\uc57c \ud55c\ub2e4. \uc544\ub2c8 \uadf8 \uc804\uc5d0 \ud2b8\ub79c\uc7ad\uc158\uc740 \ubb34\uc5c7\uc77c\uae4c? \uc5ec\uae30\uc11c\ubd80\ud130 \uc2dc\uc791\ud558\ub294 \uac8c \uc633\uaca0\ub2e4.\\n\\n\ud2b8\ub79c\uc7ad\uc158\uc740 DBMS\uc5d0\uc11c \uc218\ud589\ub418\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \uc0c1\ud0dc\ub97c \ubcc0\ud654\uc2dc\ud0a4\uae30 \uc704\ud574 \uc218\ud589\ub418\ub294 \ub17c\ub9ac\uc801\uc778 \uc791\uc5c5 \ub2e8\uc704\ub77c\uace0 \ub9d0\ud560 \uc218 \uc788\ub2e4.\\n\\n```\\n1. \uc7ac\uace0 \uc870\ud68c\\n\\t2. FOR \uad6c\ub9e4\ubc18\ubcf5 {\\n\\t\\t3. \uc544\uc774\ud15c \uac2f\uc218 \uac10\uc18c\\n\\t\\t4. \uc544\uc774\ud15c \ub124\uc774\ubc0d \uc22b\uc790 \uc99d\uac00\\n\\t\\t5. \uc544\uc774\ud15c \uc0dd\uc131\\n\\t\\t6. \uc7ac\uace0 \uac10\uc18c\\n\\t\\t7. \uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8\\n\\t\\t8. \uc7ac\uace0 \uc5c5\ub370\uc774\ud2b8\\n\\t}\\n```\\n\\n\uc774 \uc608\uc2dc\ub97c \ub2e4\uc2dc \uac00\uc838\uc624\uc790. \uc608\ub97c \ub4e4\uc5b4\uc11c \ub0b4\uac00 \uc544\uc774\ud15c 3\uac1c\ub97c \uad6c\ub9e4\ud588\ub2e4. \uadf8\ub7fc \uc800 \uad6c\ub9e4 \ubc18\ubcf5\ubb38\uc744 3\ubc88 \ub3cc\uc544 \ucffc\ub9ac\uac00 \ubaa8\ub450 \uc2e4\ud589\ub418\uc5b4 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc801\uc6a9\ub428\uc774 \ub9c8\ub545\ud558\ub2e4.\\n\\n\ud558\uc9c0\ub9cc \uccab \ubc88\uc9f8 \ubc18\ubcf5\uc740 \uc131\uacf5\ud574\uc11c \uc544\uc774\ud15c \ud558\ub098\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc0dd\uc131\ub418\uc5c8\uc73c\ub098 \uadf8 \uc774\ud6c4 \ub450 \ubc88\uc9f8 \ubc18\ubcf5\uc5d0\uc11c \uc2e4\ud328\ud574 \ub450 \ubc88\uc9f8 \uc544\uc774\ud15c\ubd80\ud130 \uc0dd\uc131\uc774 \ub418\uc9c0 \uc54a\uc558\ub2e4\uace0 \ud558\uc790. \uadf8\ub7fc \uc774 \uad6c\ub9e4 \uc2e4\ud589\uc740 \uc5b4\ub5bb\uac8c \ub418\uc5b4\uc57c \ud560\uae4c?\\n\\n1. \uc804\uccb4\uac00 \uc2e4\ud328\ud574\uc57c \ud55c\ub2e4.\\n2. \uccab \ubc88\uc9f8 \uc544\uc774\ud15c\uc740 \uad6c\ub9e4 \uc131\uacf5, \uc774\ud6c4\ub294 \uc2e4\ud328\\n\\n\uc815\ub2f5\uc740 1\ubc88\uc774\ub2e4. \uc774\ub7f0 \ud2b8\ub79c\uc7ad\uc158\uc758 \uc131\uc9c8\uc740 \uc774\ubbf8 \uacf5\ubd80\ud558\uae30 \uc88b\uac8c \uc815\uc758\ub418\uc5b4 \uc788\ub2e4. ACID\ub77c \ubd88\ub9ac\ub294 \ud2b8\ub79c\uc7ad\uc158\uc758 \uc131\uc9c8\uc774\ub2e4.\\n\\n### \ud2b8\ub79c\uc7ad\uc158\uc758 \uc131\uc9c8 ACID\\n\\n- Atomicity \uc6d0\uc790\uc131\\n- Consistency \uc77c\uad00\uc131\\n- Isolation \uaca9\ub9ac, \uace0\ub9bd\uc131\\n- Durability \uc9c0\uc18d\uc131\\n\\n\uac01\uac01 \uc131\uc9c8\uc740 \ubb34\uc5c7\uc744 \ub73b\ud560\uae4c?\\n\\n**\uc6d0\uc790\uc131**\uc740 \ud558\ub098\uc758 \ud2b8\ub79c\uc7ad\uc158\uc774 \ubaa8\ub450 \uc131\uacf5\ud558\uac70\ub098 \ubaa8\ub450 \uc2e4\ud328\ud574\uc57c \ud558\ub294 \uc131\uc9c8\uc744 \ub9d0\ud55c\ub2e4. \uc989, \uc704\uc5d0\uc11c \uc608\uc2dc\ub85c \uc2e4\ud589\ud55c \uad6c\ub9e4 \uc791\uc5c5\uc740 \uc804\uccb4\uac00 \uc2e4\ud328\ud558\uac70\ub098 \uc804\uccb4\uac00 \uc131\uacf5\ud574\uc57c \ud55c\ub2e4\ub294 \ub9d0\uc774\ub2e4. \ub54c\ubb38\uc5d0 \uc704\uc5d0 \uc608\uc2dc\uc758 \uc815\ub2f5\uc740 1\ubc88\uc774 \ub418\uaca0\ub2e4.\\n\\n**\uc77c\uad00\uc131**\uc740 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc644\ub8cc\ub41c \uc774\ud6c4\uc5d0\ub3c4 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \uc0c1\ud0dc\uac00 \uc77c\uad00\ub418\uc5b4\uc57c \ud55c\ub2e4\ub294 \ub9d0\uc778\ub370 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \ubb34\uacb0\uc131\uc744 \ub9d0\ud55c\ub2e4. \uad6c\ub9e4\ub97c \ud558\uace0 \uad6c\ub9e4 \uc7a5\ubd80\ub97c \uae30\ub85d\ud55c\ub2e4 \ud588\uc744 \ub54c \uad6c\ub9e4\uc5d0 \ub300\ud55c \uad6c\ub9e4 \uc7a5\ubd80 \ub370\uc774\ud130\uac00 \ube60\uc9c0\uba74 \uc548 \ub41c\ub2e4. \uc774\ub7f0 \uc77c\uad00\uc131\uc744 \ub9d0\ud558\uae30\ub3c4 \ud558\uace0 \uae30\ubcf8 \ud0a4, \uc65c\ub9ac \ud0a4 \uac19\uc740 \uc81c\uc57d \uc870\uac74\uc744 \uc9c0\ud0a4\uba74\uc11c \ud2b8\ub79c\uc7ad\uc158\uc744 \uc218\ud589\ud558\ub294 \uac83\uc744 \uc758\ubbf8\ud558\uae30\ub3c4 \ud55c\ub2e4.\\n\\n**\uace0\ub9bd\uc131**\uc740 \ud558\ub098\uc758 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc791\uc5c5\uc744 \uc218\ud589\uc911\uc77c \ub54c \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc774 \ub07c\uc5b4\ub4e4\uc9c0 \ubabb \ud558\ub3c4\ub85d \ubcf4\uc7a5\ud574 \ud2b8\ub79c\uc7ad\uc158\ub07c\ub9ac\uc758 \uc601\ud5a5\uc774\ub098 \uac04\uc12d\uc774 \uc5c6\ub3c4\ub85d \ud558\ub294 \uac83\uc774\ub2e4.\\n\\n**\uc9c0\uc18d\uc131**\uc740 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc218\ud589\ub418\uace0 \ub09c \ub4a4\uc5d0 \ud2b8\ub79c\uc7ad\uc158\uc5d0 \ub300\ud55c \ub85c\uadf8\uac00 \ub0a8\uc544 \uacb0\uacfc\uac00 \uc548\uc815\uc801\uc73c\ub85c \ubcf4\uc874\ub418\uc5b4\uc57c \ud558\uace0 \uc601\uad6c\uc801\uc73c\ub85c \ubc18\uc601\ub418\uc5b4\uc57c \ud55c\ub2e4\ub294 \ub9d0\uc774\ub2e4.\\n\\n\ud2b8\ub79c\uc7ad\uc158\uc740 **commit**\uacfc **rollback**\uc744 \ud1b5\ud574 \ud558\ub098\uc758 \uc791\uc5c5\uc744 \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc \ud639\uc740 \uc791\uc5c5 \ucde8\uc18c\ub97c \uacb0\uc815\ud560 \uc218 \uc788\uc73c\uba70 Auto commit \uc635\uc158\uc774 \uc801\uc6a9\uc774 Default\uc778 \uacbd\uc6b0\uac00 \uc788\uc5b4 \uc798 \uccb4\ud06c\ud558\uace0 \uc0ac\uc6a9\ud574\uc57c \ud55c\ub2e4.\\n\\n## \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\\n### \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc758 \uc815\uc758\ub4e4\\n\ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc740 \ube44\uc2b7\ud558\uac70\ub098 \ub611\uac19\uc740 \ub9d0\uc774\uc9c0\ub9cc \uc774\ub807\uac8c \uc815\uc758\ud55c\ub2e4.\\n\\n- \ub3d9\uc2dc\uc5d0 \uc5ec\ub7ec \ud2b8\ub79c\uc7ad\uc158\uc774 \ucc98\ub9ac\ub420 \ub54c \ud2b8\ub79c\uc7ad\uc158\ub07c\ub9ac \uc5bc\ub9c8\ub098 \uc11c\ub85c \uace0\ub9bd\ub418\uc5b4 \uc788\ub294\uc9c0\ub97c \ub098\ud0c0\ub0b4\ub294 \uac83.\\n- \ud2b9\uc815 \ud2b8\ub79c\uc7ad\uc158\uc774 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0 \ubcc0\uacbd\ud55c \ub370\uc774\ud130\ub97c \ubcfc \uc218 \uc788\ub3c4\ub85d \ud5c8\uc6a9\ud560\uc9c0 \ub9d0\uc9c0 \uacb0\uc815\ud558\ub294 \uac83.\\n- \uc5ec\ub7ec \ud2b8\ub79c\uc7ad\uc158\uc774 \ub3d9\uc2dc\uc5d0 \ucc98\ub9ac\ub420 \ub54c \ud2b9\uc815 \ud2b8\ub79c\uc7ad\uc158\uc774 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ubcc0\uacbd\ud558\uac70\ub098 \uc870\ud68c\ud558\ub294 \ub370\uc774\ud130\ub97c \ubcfc \uc218 \uc788\uac8c \ud5c8\uc6a9\ud560\uc9c0 \uc5ec\ubd80\ub97c \uacb0\uc815\ud558\ub294 \uac83.\\n- \uc5ec\ub7ec \ud2b8\ub79c\uc7ad\uc158\uc774 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ubcc0\uacbd\ud558\uac70\ub098 \uc870\ud68c\ud558\ub294 \ub370\uc774\ud130\ub97c \ubcfc \uc218 \uc788\ub3c4\ub85d \ud5c8\uc6a9\ud560\uc9c0 \ub9d0\uc9c0\ub97c \uacb0\uc815\ud558\ub294 \uac83.\\n\\n\uc694\uc57d\ud558\uc790\uba74 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc11c\ub85c \uace0\ub9bd\ub41c \uc815\ub3c4\ub97c \ub098\ud0c0\ub0b4\uba70 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ubcc0\uacbd\ud55c \ub370\uc774\ud130\ub97c \ubcfc \uac83\uc778\uc9c0 \uacb0\uc815\ud558\ub294 \uac83.\ucbe4 \ub418\uaca0\ub2e4.\\n\\n### \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900 \uad6c\ubd84\\n\uadf8\ub7fc \uadf8 \uace0\ub9bd\ub41c \uc815\ub3c4\ub97c \ub098\ud0c0\ub0b8\ub2e4\ub294 \uc9c0\ud45c\ub294 \uc5b4\ub5bb\uac8c \uad6c\ubd84\ub418\ub294\uc9c0 \ubcf4\uc790\uba74 \uc544\ub798\uc640 \uac19\ub2e4.\\n\\n\ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc740 \uc704\uc5d0\uc11c \uc544\ub798\ub85c \ub192\uc544\uc9c4\ub2e4\uace0 \ubcf4\uba74 \ub41c\ub2e4.\\n\\n- Read uncommited (0)\\n- Read committed (1)\\n- Repeatable read (2)\\n- Serializable (3)\\n\\n### \uc8fc\uc758\ud574\uc57c \ud558\ub294 \ubd80\ubd84\\n\ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac \uc218\uc900\uc774 \ub192\uc544\uc9c8 \uc218\ub85d \uaca9\ub9ac\uc131\uc73c\ub85c \uc778\ud55c \uc774\uc288\ub294 \uc801\uac8c \ubc1c\uc0dd\ud558\uaca0\uc9c0\ub9cc \ub3d9\uc2dc \ucc98\ub9ac \uc131\ub2a5\uc774 \ub5a8\uc5b4\uc9c0\uae30 \ub54c\ubb38\uc5d0 \uc131\ub2a5 \uc694\uad6c\uc0ac\ud56d\uacfc \ub370\uc774\ud130 \ubb34\uacb0\uc131\uc744 \uace0\ub824\ud574 \uc801\uc808\ud55c \uc218\uc900\uc744 \ucc3e\uc544\uc57c \ud55c\ub2e4.\\n\\n\uac04\ub2e8\ud788 \uaca9\ub9ac \uc218\uc900\uc5d0 \ub300\ud574\uc11c \uc54c\uc544\ubcf4\uc790\uba74 \uc544\ub798\uc640 \uac19\ub2e4.\\n\\n#### Read uncommitted\\nRead uncommitted\ub294 commit\uc774\ub098 rollback \uc0c1\uad00 \uc5c6\uc774 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \uc870\ud68c\ud560 \uc218 \uc788\ub2e4. \uc774\ub294 \ub370\uc774\ud130 \uc815\ud569\uc131\uc5d0 \ubb38\uc81c\uac00 \uc788\uae30 \ub54c\ubb38\uc5d0 \uad8c\uc7a5\ub418\uc9c0 \uc54a\ub294\ub2e4.\\n\\n#### Read committed\\nDBMS\uc5d0\uc11c \uac00\uc7a5 \ub9ce\uc774 \uc0ac\uc6a9\ub418\ub294 \uaca9\ub9ac \uc218\uc900\uc73c\ub85c \ud2b8\ub79c\uc7ad\uc158 \ubcc0\uacbd \ub0b4\uc6a9\uc774 commit \ub418\uc5b4\uc57c\ub9cc \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \uc870\ud68c\ud560 \uc218 \uc788\ub2e4.\\n\\n#### Repeatable read\\n\ud2b8\ub79c\uc7ad\uc158\uc774 \uc2dc\uc791\ub418\uae30 \uc804\uc5d0 \ucee4\ubc0b\ub41c \ub0b4\uc6a9\uc5d0 \ub300\ud574\uc11c\ub9cc \uc870\ud68c\ud560 \uc218 \uc788\ub294 \uaca9\ub9ac \uc218\uc900\uc774\ub2e4.\\n\\n#### Serializable\\nInnoDB\uc5d0\uc11c \uc21c\uc218\ud55c SELECT\ub294 \uc5b4\ub5a4 \uc7a0\uae08\ub3c4 \uc5c6\uc774 \ub3d9\uc791\ud558\ub294\ub370 \uc774\ub54c \uacf5\uc720 \uc7a0\uae08\uc744 \uc124\uc815\ud558\uc5ec \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ub808\ucf54\ub4dc \ubcc0\uacbd\uc744 \ud560 \uc218 \uc5c6\uac8c \ub9cc\ub4e0\ub2e4. \uc989, SELECT\uac00 \uc0ac\uc6a9\ub418\ub294 \ub370\uc774\ud130\ub4e4\uc5d0 Shared Lock\uc744 \uac78\uae30 \ub54c\ubb38\uc5d0 \ub3d9\uc2dc \ucc98\ub9ac \ub2a5\ub825\uc774 \ub5a8\uc5b4\uc9c0\uace0 \uc131\ub2a5 \uc800\ud558\uac00 \ubc1c\uc0dd\ub41c\ub2e4.\\n\\n## \ud2b8\ub79c\uc7ad\uc158 \uaca9\ub9ac\uc131\uc73c\ub85c \uc0dd\uae38 \uc218 \uc788\ub294 \uc774\uc288\ub4e4\\n### Dirty Read\\nRead Uncommitted \uaca9\ub9ac \uc218\uc900\uc5d0\uc11c \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc544\uc9c1 \ucee4\ubc0b\ub418\uc9c0 \uc54a\uc740 \ub370\uc774\ud130\ub97c \uc77d\uc744 \uc218 \uc788\ub294 \uc774\uc288\uc774\ub2e4.\\n\\n### Non-Repeatable Read\\nRead committed \ub2e8\uacc4\uc5d0\uc11c \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc774 \ucee4\ubc0b\ud55c \ub370\uc774\ud130\ub97c \uc77d\uc744 \uc218 \uc788\ub294 \uac83\uc744 \uc758\ubbf8\ud55c\ub2e4. \ud55c \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ucffc\ub9ac\ub85c 2\ubc88 \uc774\uc0c1 \uc870\ud68c\ud588\uc744 \ub54c \uadf8 \uacb0\uacfc\uac00 \uc0c1\uc774\ud55c \uc774\uc288\ub97c \ub9d0\ud55c\ub2e4.\\n\\n### Phantom Read\\nRepeatable read \uaca9\ub9ac \uc218\uc900\uc5d0\uc11c \ud55c \ud2b8\ub79c\uc7ad\uc158\uc774 \ub3d9\uc77c\ud55c \ucffc\ub9ac\ub97c \ub450 \ubc88 \uc2e4\ud589\ud560 \ub54c, \ub450 \ubc88\uc9f8 \uc2e4\ud589\uc5d0\uc11c\ub294 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc774 \ucee4\ubc0b\ud55c \ub370\uc774\ud130\ub97c \uc77d\uc744 \uc218 \uc788\ub294 \uc774\uc288\uc774\ub2e4.\\n\\n## \uacb0\uad6d \ud574\uacb0\ud55c \ubc29\ubc95\\n\uacb0\uad6d \ud574\uacb0\ud55c \ubc29\ubc95\\n\uc870\ud68c \ucffc\ub9ac\uc5d0 \ud2b8\ub79c\uc7ad\uc158\uc744 \uc801\uc6a9\ud574 \uc8fc\uc5c8\ub2e4.\\n\\n```go\\nfunc (r userRepositoryImpl) FindByNickname(ctx context.Context, req *ent.User) (*ent.User, error) {\\n\\treturn r.User.Query().\\n\\t\\tWhere(user.NicknameEQ(req.Nickname)).\\n\\t\\tOnly(ctx)\\n}\\n```\\n\\nGolnag \uc608\uc2dc\ub97c \ubcf4\uba74 \uc9c0\uae08 \uc774 Repository \ub85c\uc9c1\uc740 \ud2b8\ub79c\uc7ad\uc158\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \uc870\ud68c\uc774\ub2e4.\\n\\n```go\\nfunc (r userRepositoryImpl) FindByNickname(ctx context.Context, req *ent.User, tx *ent.Tx) (*ent.User, error) {\\n\\treturn tx.User.Query().\\n\\t\\tWhere(user.NicknameEQ(req.Nickname)).\\n\\t\\tOnly(ctx)\\n}\\n```\\n\\n\uc774 Repository \ub85c\uc9c1\uc740 \ud2b8\ub79c\uc7ad\uc158\uc744 \uc0ac\uc6a9\ud558\ub294 \uc870\ud68c \ub85c\uc9c1\uc774\ub2e4.  Spring\uc5d0\uc11c `@Transactional`\uc774\ub77c\ub294 \uc5b4\ub178\ud14c\uc774\uc158\uc744 \uc0ac\uc6a9\ud574\uc11c \ud2b8\ub79c\uc7ad\uc158\uc744 \uad00\ub9ac\ud558\uc9c0\ub9cc Golang\uc758 Ent Orm\uc5d0\uc11c\ub294 Tx\ub77c\ub294 \ud2b8\ub79c\uc7ad\uc158\uc744 \uc9c1\uc811 \uc0dd\uc131\ud558\uc5ec \uc8fc\uc785\ud574 \uc8fc\uc5b4\uc57c \ud55c\ub2e4.\\n\\n\uc870\ud68c \ubd80\ubd84\uc5d0 \ucd94\uac00\ub418\ub294 \ud2b8\ub79c\uc7ad\uc158\uc740 Repeatable read \uaca9\ub9ac \uc218\uc900\uc5d0\uc11c \ucc28\uc774\uac00 \ub098\uae30 \ub54c\ubb38\uc5d0 \uc774\ub97c \uc801\uc6a9\ud574 \uc8fc\uc5b4 \ud574\uacb0\ud588\ub2e4."}]}')}}]);